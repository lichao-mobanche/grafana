sudo: true
language: go
go: 1.8.x
before_install:
- curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash
- source ~/.bashrc
- nvm install stable
- npm install -g yarn
- yarn install --pure-lockfile
- npm install -g grunt-cli
script:
- mv $GOPATH/src/github.com/lichao-mobanche $GOPATH/src/github.com/grafana
- make
after_script:
- apt-get install gnu-tar
- apt-get install rpm
- gem install fpm
- go run build.go package
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    source: KzQjsdkw+QAhqhHXV0LsVSRoVs/5OCRDa40+/jHMq1DgK6S9x/+GajQj6wmQWyNYqKicWyG/cCUBHSsCwy3b/XyXwOYsWCdn4nsRgo5FIAghzGTPBU/0XoIRMzBC++ht/8LpGw4oouuFrHGScacI8n6QZZ2vYYCXja+uhMaDazcJtrRdTnoyZPKYwBfJhAeX6/JmOnttLqsyllP1ySefJrbMC8tDtEEIeydvNCk+MtI1fppOhrq1bFTtzQzvT7dt21Vnp7T4Dfe5yluY/Ms4wcKZgAg89opedkoYj6CAqi9tZGa65pw5/PpIiH40I8BrJ72YMgUM5PteDIPFdF3j6zEEb1nmTiSJ+xEuhR4jCu2NWmKom7xszm4rboSAtCMZhaC26uXyuLbZksLCVIlKHQg8rvXChlHTSvDW50B/b02ZjMLmSAx5aN6e36czBI83hWBF5Rm7ywBnKPz+gS1M7wFtNSANKBnQi0AjW5nbqTOUk+j8UvlJ85yiCEjTYgHW8LpyLWbVm8YBMOVQGNmf+s4I58/yXFvZxnEH8zd/U8Gabv4gwFEYfWfuZLsF9Jf4AgVgJfgODDc3anuZYUN0evZcwvjyvZKjqohgpuynwWkPkOuEGCznV8BiIRpr447Olqz1Yen0aDxv5ULNwBF2axOuUHES27sv5oAU8yHmzj8=
  file:
  - dist/grafana-4.4.3-1.x86_64.rpm
  - dist/grafana_4.4.3_amd64.deb
  on:
    tags: true
    repo: lichao-mobanche/grafana

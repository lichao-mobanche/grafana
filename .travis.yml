sudo: true
language: go
go: 1.8.x
before_install:
- curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.31.1/install.sh | bash
- source ~/.bashrc
- nvm install stable
- npm install -g yarn
- yarn install --pure-lockfile
- npm install -g grunt-cli
script:
- mv $GOPATH/src/github.com/lichao-mobanche $GOPATH/src/github.com/grafana
- make
after_script:
- apt-get install gnu-tar
- apt-get install rpm
- gem install fpm
- go run build.go package
deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: w3Bvyf/aAATvwynQpEiTZHpNZE2PJHquFHzgwUVH2/sTpmZJ95JBPGpvGzcGo+ndN1R8YYbYinX8BhrFVimKn9qg2OYbfGx6bsiSkfoFq5o3So2eUbzX2O5Ieby0n7FU3f7egbeoBtSHvE4Cg9wt1BkuH/6Pw7OrbSm0EYt7w2pbmAO7kZZD5j2OsWmkBhgyptKfoGApc38p4dcfVs7XcY8s9Hs6h188ZcolzddKl3KRVU+0OcQ5Vxob3qZK4AYdtOl7Wo0cgq1VYRYo+eJXDTwVVeYJJXLhNXBrqrtMCKpclz98ZK2VzBtoJo/g6HV1C1EmNeT19ZuLPH54ns+x3d2LuOUkn83c6dg/U1g7qLzm4xYZdRKCUw2dwOltfKyUhGlZ7rCB2qpey8Rn0XO1JPrkzj1XnwLFXRWxAaK/vEmC4xt4WKIfL9Dq562hQgfEqpqBAATpTJ0sJVRYWx1T+s7jzog5TeNHvRLR/9DoJDBxphixFuxnKhp0CeT7sbc+CL3H6ozdSzpDCvOJOCGWVpH/SMvmVzAETckHVrExohCyfpIhCpDpeeAl9q0gviBSVLG08R1NE/j2HUcy6UUtCPasccus7o5pomNzLZ66wCZo+xDW5+O44TTR8/bxXbxOcnmJNiaIcovEHd4LKaqLRWfMeF9uAYHxRGY++Ky8dWg=
  file: 
  - dist/grafana-4.4.3-1.x86_64.rpm
  - dist/grafana_4.4.3_amd64.deb
  on:
    tags: true
